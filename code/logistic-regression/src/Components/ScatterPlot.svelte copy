<script>
    import { scatterData } from "../datasets.js";
    import { scaleLinear } from "d3-scale";
    import { max, min } from "d3-array";
    let width = 500;
    let height = 500;
    const margin = { top: 20, right: 40, bottom: 30, left: 40 };

    $: xScale = scaleLinear()
        .domain([
            min(scatterData, (d) => d.Temperature),
            max(scatterData, (d) => d.Temperature),
        ])
        .range([margin.left, width - margin.right]);

    $: yScale = scaleLinear()
        .domain([
            min(scatterData, (d) => d.Weather),
            max(scatterData, (d) => d.Weather),
        ])
        .range([height - margin.bottom, margin.top]);

</script>

<div id="scatter-chart" bind:offsetWidth={width} bind:offsetHeight={height}>
    <svg {width} {height}>
        <!-- x ticks -->
        {#each xScale.ticks() as d}
            <g transform={`translate(${xScale(d)}, ${height - margin.bottom})`}>
                <line
                    class="grid-line"
                    x1="0"
                    x2="0"
                    y1="0"
                    y2={-height + margin.bottom + margin.top}
                />
                <text class="axis-text" y="15" text-anchor="middle">{d}</text>
            </g>
        {/each}
        <!-- y ticks -->
        {#each yScale.ticks() as d}
            <g transform={`translate(${margin.left}, ${yScale(d)})`}>
                <line
                    class="grid-line"
                    x1="0"
                    x2={width - margin.left - margin.right}
                    y1="0"
                    y2="0"
                />
                <text
                    class="axis-text"
                    text-anchor="end"
                    dominant-baseline="middle">{d}</text
                >
            </g>
        {/each}

        <!-- axis lines -->
        <line
            class="axis-line"
            x1={xScale(xScale.ticks()[0])}
            x2={width - margin.right}
            y1={height - margin.bottom}
            y2={height - margin.bottom}
        />
        <line
            class="axis-line"
            x1={xScale(xScale.ticks()[0])}
            x2={xScale(xScale.ticks()[0])}
            y1={height - margin.bottom}
            y2={margin.top}
        />

        <!-- points -->
        
        <!-- {#each scatterData as item}
            <circle
                r="3"
                cx={scatterData.xScale(item.Temperature)}
                cy={scatterData.yScale(item.Weather)}
                fill={scatterData.colorScale(item.Weather)}
            />
        {/each} -->
    </svg>
</div>

<style>
    svg {
        /* background-color: blue; */
    }

    #scatter-chart {
        width: 100%;
        max-height: 98%;
    }

    .grid-line {
        fill: none;
        stroke: black;
        stroke-dasharray: 4;
        stroke-opacity: 0.2;
    }

    .axis-line {
        fill: none;
        stroke: black;
    }
</style>
